{"remainingRequest":"D:\\git\\hualiyeya\\web\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js??vue-loader-options!D:\\git\\hualiyeya\\web\\src\\components\\view\\AddNewMaintenance.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\git\\hualiyeya\\web\\src\\components\\view\\AddNewMaintenance.vue","mtime":1591837889537},{"path":"D:\\git\\hualiyeya\\web\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\git\\hualiyeya\\web\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\git\\hualiyeya\\web\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\git\\hualiyeya\\web\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { provinceAndCityData, regionData, provinceAndCityDataPlus, regionDataPlus, CodeToText, TextToCode } from 'element-china-area-data';\r\nexport default {\r\n    name: 'AddRepair',\r\n    data() {\r\n        return {\r\n            enterprise_id: '',\r\n            enterprises: [],\r\n            devices: [],\r\n            faultType: [],\r\n            choosefault: [],\r\n            eq: '',\r\n            // selectedfaultType: '',\r\n\r\n            //options: regionData,\r\n            form: {},\r\n            selectedOptions: ''\r\n        };\r\n    },\r\n    computed: {},\r\n    created() {\r\n        this.getEnterprises();\r\n        this.getFaultType();\r\n    },\r\n    mounted() {},\r\n    methods: {\r\n        //获取企业选项\r\n        getEnterprises() {\r\n            this.$axios\r\n                .get('/Enterprise')\r\n                .then(res => {\r\n                    // console.log(res.data);\r\n                    this.enterprises = res.data;\r\n                })\r\n                .catch(err => {\r\n                    console.log(err);\r\n                });\r\n        },\r\n        //获取设备ID\r\n        getDevices(value) {\r\n            // console.log(value);\r\n\r\n            this.$axios\r\n                .post('/Devices', { enterprise_id: value })\r\n                .then(res => {\r\n                    console.log(res);\r\n                    this.devices = res.data;\r\n                    console.log(this.devices);\r\n                })\r\n                .catch(err => {\r\n                    console.log(err);\r\n                });\r\n        },\r\n\r\n        //获取故障类型、故障现象选项\r\n        getFaultType() {\r\n            this.$axios\r\n                .get('/FaultTypeChoose')\r\n                .then(res => {\r\n                    console.log(res.data);\r\n                    this.faultType = res.data;\r\n                })\r\n                .catch(err => {\r\n                    console.log(err);\r\n                });\r\n        },\r\n\r\n        //处理选择故障类型和故障现象\r\n        handelchoosefault() {\r\n            console.log(1);\r\n            for (var i = 0; i < this.faultType.length; i++) {\r\n                if (this.faultType[i].fault_type === this.form.type) {\r\n                    this.choosefault = this.faultType[i].fault_phenomenon;\r\n                }\r\n            }\r\n        },\r\n\r\n        onSubmit() {\r\n            if (this.enterprise_id == null || this.enterprise_id == 0) {\r\n                this.$message.error(`请选择企业名称`);\r\n            } else if (this.form.device_id == 0 || this.form.device_id == null) {\r\n                this.$message.error(`请选择设备ID`);\r\n            } else if (this.form.type == '' || this.form.type == null) {\r\n                this.$message.error(`请选择故障类型`);\r\n            } else if (this.form.phenomenon == '' || this.form.phenomenon == null) {\r\n                this.$message.error(`请选择故障现象`);\r\n            } else {\r\n                // let date = new Date();\r\n                // this.form.created_time = date.getTime();\r\n                axios({\r\n                    method: 'post',\r\n                    url: '/AddRepair',\r\n                    data: this.form\r\n                })\r\n                    .then(res => {\r\n                        window.console.log(res.data);\r\n                        this.$message.success('提交成功！');\r\n                        this.$refs.form.resetFields();\r\n                        setTimeout(() => {\r\n                            this.$router.go(-1);\r\n                        }, 1000);\r\n                    })\r\n                    .catch(err => {});\r\n            }\r\n        },\r\n        // handleChange() {\r\n        //     this.form.Province = CodeToText[this.selectedOptions[0]];\r\n        //     this.form.City = CodeToText[this.selectedOptions[1]];\r\n        //     this.form.District = CodeToText[this.selectedOptions[2]];\r\n        //     window.console.log(this.selectedOptions);\r\n        // },\r\n        resetForm(formName) {\r\n            this.$refs[formName].resetFields();\r\n            this.$router.go(-1)\r\n        },\r\n        //过滤搜索，queryString必须包含有value键值对\r\n        querySearch(queryString, cb) {\r\n            var devices = this.devices;\r\n            var results = queryString ? devices.filter(this.createFilter(queryString)) : devices;\r\n            // 调用 callback 返回建议列表的数据\r\n            cb(results);\r\n        },\r\n        createFilter(queryString) {\r\n            return devices => {\r\n                return devices.value.toLowerCase().indexOf(queryString.toLowerCase()) === 0;\r\n            };\r\n        },\r\n\r\n        handleSelect(item) {\r\n            this.form.device_id = item.id;\r\n        }\r\n    }\r\n};\r\n",{"version":3,"sources":["AddNewMaintenance.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"AddNewMaintenance.vue","sourceRoot":"src/components/view","sourcesContent":["<!--\r\n * @Author: your name\r\n * @Date: 2020-05-06 14:19:13\r\n * @LastEditTime: 2020-06-08 09:31:03\r\n * @LastEditors: Please set LastEditors\r\n * @Description: In User Settings Edit\r\n * @FilePath: \\vue-manage-system\\src\\components\\view\\AddNewProduct.vue\r\n -->\r\n<template>\r\n    <div>\r\n        <div class=\"crumbs\">\r\n            <el-breadcrumb separator=\"/\">\r\n                <el-breadcrumb-item>\r\n                    <i class=\"el-icon-lx-calendar\"></i> 设备档案\r\n                </el-breadcrumb-item>\r\n                <el-breadcrumb-item>添加维修记录</el-breadcrumb-item>\r\n            </el-breadcrumb>\r\n        </div>\r\n        <div class=\"container\">\r\n            <el-button type=\"primary\" @click=\"$router.go(-1)\">返回</el-button>\r\n\r\n            <div class=\"form-box\">\r\n                <el-form ref=\"form\" :model=\"form\" label-width=\"120px\">\r\n                    <el-form-item label=\"企业名称\" prop=\"enterprise_id\">\r\n                        <el-select\r\n                            v-model=\"enterprise_id\"\r\n                            placeholder=\"请选择企业\"\r\n                            @change=\"getDevices(enterprise_id)\"\r\n                        >\r\n                            <el-option\r\n                                v-for=\"enterprise in enterprises\"\r\n                                :label=\"enterprise.enterprise_name\"\r\n                                :value=\"enterprise.id\"\r\n                                :key=\"enterprise\"\r\n                            ></el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"设备ID\" prop=\"device_id\">\r\n                        <el-autocomplete\r\n                            v-model=\"eq\"\r\n                            class=\"inline-input\"\r\n                            :fetch-suggestions=\"querySearch\"\r\n                            placeholder=\"请输入设备ID\"\r\n                            @select=\"handleSelect\"\r\n                        ></el-autocomplete>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"故障类型\">\r\n                        <el-select\r\n                            v-model=\"form.type\"\r\n                            placeholder=\"请选择故障类型\"\r\n                            @change=\"handelchoosefault\"\r\n                        >\r\n                            <el-option\r\n                                v-for=\"(type,index) in faultType\"\r\n                                :label=\"type.fault_type\"\r\n                                :value=\"type.fault_type\"\r\n                                :key=\"index\"\r\n                            ></el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"故障现象\">\r\n                        <el-select v-model=\"form.phenomenon\" placeholder=\"请选择故障现象\">\r\n                            <el-option\r\n                                v-for=\"phenomenon in choosefault\"\r\n                                :label=\"phenomenon\"\r\n                                :value=\"phenomenon\"\r\n                                :key=\"phenomenon\"\r\n                            ></el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n\r\n                    <el-form-item label=\"可能产生的原因\" prop=\"cause\">\r\n                        <el-input v-model=\"form.cause\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"排除方法\" prop=\"methods\">\r\n                        <el-input v-model=\"form.methods\"></el-input>\r\n                    </el-form-item>\r\n\r\n                    <el-form-item label=\"维修人\" prop=\"repair_person\">\r\n                        <el-input v-model=\"form.repair_person\" type=\"text\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"备注\" prop=\"more\">\r\n                        <el-input v-model=\"form.more\" type=\"text\"></el-input>\r\n                    </el-form-item>\r\n\r\n                    <el-form-item>\r\n                        <el-button type=\"primary\" @click=\"onSubmit\">提交</el-button>\r\n                        <el-button @click=\"resetForm('form')\">取消</el-button>\r\n                    </el-form-item>\r\n                </el-form>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { provinceAndCityData, regionData, provinceAndCityDataPlus, regionDataPlus, CodeToText, TextToCode } from 'element-china-area-data';\r\nexport default {\r\n    name: 'AddRepair',\r\n    data() {\r\n        return {\r\n            enterprise_id: '',\r\n            enterprises: [],\r\n            devices: [],\r\n            faultType: [],\r\n            choosefault: [],\r\n            eq: '',\r\n            // selectedfaultType: '',\r\n\r\n            //options: regionData,\r\n            form: {},\r\n            selectedOptions: ''\r\n        };\r\n    },\r\n    computed: {},\r\n    created() {\r\n        this.getEnterprises();\r\n        this.getFaultType();\r\n    },\r\n    mounted() {},\r\n    methods: {\r\n        //获取企业选项\r\n        getEnterprises() {\r\n            this.$axios\r\n                .get('/Enterprise')\r\n                .then(res => {\r\n                    // console.log(res.data);\r\n                    this.enterprises = res.data;\r\n                })\r\n                .catch(err => {\r\n                    console.log(err);\r\n                });\r\n        },\r\n        //获取设备ID\r\n        getDevices(value) {\r\n            // console.log(value);\r\n\r\n            this.$axios\r\n                .post('/Devices', { enterprise_id: value })\r\n                .then(res => {\r\n                    console.log(res);\r\n                    this.devices = res.data;\r\n                    console.log(this.devices);\r\n                })\r\n                .catch(err => {\r\n                    console.log(err);\r\n                });\r\n        },\r\n\r\n        //获取故障类型、故障现象选项\r\n        getFaultType() {\r\n            this.$axios\r\n                .get('/FaultTypeChoose')\r\n                .then(res => {\r\n                    console.log(res.data);\r\n                    this.faultType = res.data;\r\n                })\r\n                .catch(err => {\r\n                    console.log(err);\r\n                });\r\n        },\r\n\r\n        //处理选择故障类型和故障现象\r\n        handelchoosefault() {\r\n            console.log(1);\r\n            for (var i = 0; i < this.faultType.length; i++) {\r\n                if (this.faultType[i].fault_type === this.form.type) {\r\n                    this.choosefault = this.faultType[i].fault_phenomenon;\r\n                }\r\n            }\r\n        },\r\n\r\n        onSubmit() {\r\n            if (this.enterprise_id == null || this.enterprise_id == 0) {\r\n                this.$message.error(`请选择企业名称`);\r\n            } else if (this.form.device_id == 0 || this.form.device_id == null) {\r\n                this.$message.error(`请选择设备ID`);\r\n            } else if (this.form.type == '' || this.form.type == null) {\r\n                this.$message.error(`请选择故障类型`);\r\n            } else if (this.form.phenomenon == '' || this.form.phenomenon == null) {\r\n                this.$message.error(`请选择故障现象`);\r\n            } else {\r\n                // let date = new Date();\r\n                // this.form.created_time = date.getTime();\r\n                axios({\r\n                    method: 'post',\r\n                    url: '/AddRepair',\r\n                    data: this.form\r\n                })\r\n                    .then(res => {\r\n                        window.console.log(res.data);\r\n                        this.$message.success('提交成功！');\r\n                        this.$refs.form.resetFields();\r\n                        setTimeout(() => {\r\n                            this.$router.go(-1);\r\n                        }, 1000);\r\n                    })\r\n                    .catch(err => {});\r\n            }\r\n        },\r\n        // handleChange() {\r\n        //     this.form.Province = CodeToText[this.selectedOptions[0]];\r\n        //     this.form.City = CodeToText[this.selectedOptions[1]];\r\n        //     this.form.District = CodeToText[this.selectedOptions[2]];\r\n        //     window.console.log(this.selectedOptions);\r\n        // },\r\n        resetForm(formName) {\r\n            this.$refs[formName].resetFields();\r\n            this.$router.go(-1)\r\n        },\r\n        //过滤搜索，queryString必须包含有value键值对\r\n        querySearch(queryString, cb) {\r\n            var devices = this.devices;\r\n            var results = queryString ? devices.filter(this.createFilter(queryString)) : devices;\r\n            // 调用 callback 返回建议列表的数据\r\n            cb(results);\r\n        },\r\n        createFilter(queryString) {\r\n            return devices => {\r\n                return devices.value.toLowerCase().indexOf(queryString.toLowerCase()) === 0;\r\n            };\r\n        },\r\n\r\n        handleSelect(item) {\r\n            this.form.device_id = item.id;\r\n        }\r\n    }\r\n};\r\n</script>\r\n<style scoped>\r\n.form-box {\r\n    margin: 0 auto;\r\n}\r\n</style>"]}]}